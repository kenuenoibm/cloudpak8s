{"version":3,"sources":["webpack:///./node_modules/gatsby-theme-carbon/src/components/PageHeader/index.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/PageHeader/PageHeader.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/EditLink/index.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/EditLink/EditLink.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/PageTabs/index.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/PageTabs/PageTabs.js","webpack:///./node_modules/gatsby-theme-carbon/src/templates/Default.js","webpack:///./src/pages/day2/Sup_EfkAws/index.mdx"],"names":["PageHeader","title","tabs","className","cx","pageHeader","withTabs","length","id","text","EditLink","relativePagePath","repositoryProp","repository","site","siteMetadata","baseUrl","subDirectory","href","branch","row","link","PageTabs","render","this","props","slug","currentTab","split","filter","Boolean","slice","pageTabs","map","tab","slugifiedTab","slugify","lower","selected","currentTabRegex","RegExp","replace","key","selectedItem","listItem","to","tabsContainer","list","React","Component","Default","pageContext","children","location","Title","frontmatter","titleType","theme","description","keywords","pathPrefix","pathname","Layout","homepage","pageTitle","pageDescription","pageKeywords","label","Main","padded","NextPrevious","BackToTopBtn","_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","mdxType","parentName","isMDXComponent"],"mappings":"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","file":"component---src-pages-day-2-sup-efk-aws-index-mdx-63d0479f7f02de5e82a7.js","sourcesContent":["import PageHeader from './PageHeader';\n\nexport default PageHeader;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport cx from 'classnames';\nimport { pageHeader, withTabs, text } from './PageHeader.module.scss';\n\nconst PageHeader = ({ title, tabs = [] }) => (\n  <div className={cx(pageHeader, { [withTabs]: tabs.length })}>\n    <div className=\"bx--grid\">\n      <div className=\"bx--row\">\n        <div className=\"bx--col-lg-12\">\n          <h1 id=\"page-title\" className={text}>\n            {title}\n          </h1>\n        </div>\n      </div>\n    </div>\n  </div>\n);\n\nPageHeader.propTypes = {\n  /**\n   * Specify the title for the page\n   */\n  title: PropTypes.node,\n};\n\nexport default PageHeader;\n","import EditLink from './EditLink';\n\nexport default EditLink;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { graphql, useStaticQuery } from 'gatsby';\n\nimport { link, row } from './EditLink.module.scss';\n\nconst EditLink = ({ relativePagePath, repository: repositoryProp }) => {\n  const {\n    site: {\n      siteMetadata: { repository },\n    },\n  } = useStaticQuery(graphql`\n    query REPOSITORY_QUERY {\n      site {\n        siteMetadata {\n          repository {\n            baseUrl\n            subDirectory\n            branch\n          }\n        }\n      }\n    }\n  `);\n\n  const { baseUrl, subDirectory, branch } = repositoryProp || repository;\n\n  const href = `${baseUrl}/edit/${branch}${subDirectory}/src/pages${relativePagePath}`;\n\n  return baseUrl ? (\n    <div className={`bx--row ${row}`}>\n      <div className=\"bx--col\">\n        <a className={link} href={href}>\n          Edit this page on GitHub\n        </a>\n      </div>\n    </div>\n  ) : null;\n};\n\nEditLink.propTypes = {\n  repository: PropTypes.shape({\n    baseUrl: PropTypes.string,\n    subDirectory: PropTypes.string,\n    branch: PropTypes.string,\n  }),\n  relativePagePath: PropTypes.string,\n};\n\nexport default EditLink;\n","import PageTabs from './PageTabs';\n\nexport default PageTabs;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from 'gatsby';\nimport slugify from 'slugify';\nimport cx from 'classnames';\n\nimport {\n  tabsContainer,\n  list,\n  selectedItem,\n  listItem,\n  link,\n} from './PageTabs.module.scss';\n\nexport default class PageTabs extends React.Component {\n  static propTypes = {\n    tabs: PropTypes.array,\n    slug: PropTypes.string,\n  };\n\n  render() {\n    const { tabs, slug } = this.props;\n    const currentTab = slug\n      .split('/')\n      .filter(Boolean)\n      .slice(-1)[0];\n\n    const pageTabs = tabs.map(tab => {\n      const slugifiedTab = slugify(tab, { lower: true });\n      const selected = slugifiedTab === currentTab;\n      const currentTabRegex = new RegExp(`${currentTab}(?!-)`);\n      const href = slug.replace(currentTabRegex, slugifiedTab);\n      return (\n        <li key={tab} className={cx({ [selectedItem]: selected }, listItem)}>\n          <Link className={link} to={`${href}`}>\n            {tab}\n          </Link>\n        </li>\n      );\n    });\n\n    return (\n      <div className={tabsContainer}>\n        <div className=\"bx--grid\">\n          <div className=\"bx--row\">\n            <div className=\"bx--col-lg-12 bx--col-no-gutter\">\n              <nav>\n                <ul className={list}>{pageTabs}</ul>\n              </nav>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport slugify from 'slugify';\nimport { useStaticQuery, graphql } from 'gatsby';\n\nimport BackToTopBtn from '../components/BackToTopBtn';\nimport Layout from '../components/Layout';\nimport PageHeader from '../components/PageHeader';\nimport EditLink from '../components/EditLink';\nimport NextPrevious from '../components/NextPrevious';\nimport PageTabs from '../components/PageTabs';\nimport Main from '../components/Main';\n\nconst Default = ({ pageContext, children, location, Title }) => {\n  const { frontmatter = {}, relativePagePath, titleType } = pageContext;\n  const { tabs, title, theme, description, keywords } = frontmatter;\n\n  // get the path prefix if it exists\n  const {\n    site: { pathPrefix },\n  } = useStaticQuery(graphql`\n    query PATH_PREFIX_QUERY {\n      site {\n        pathPrefix\n      }\n    }\n  `);\n\n  // let gatsby handle prefixing\n  const slug = pathPrefix\n    ? location.pathname.replace(pathPrefix, '')\n    : location.pathname;\n\n  const getCurrentTab = () => {\n    if (!tabs) return '';\n    return (\n      slug\n        .split('/')\n        .filter(Boolean)\n        .slice(-1)[0] || slugify(tabs[0], { lower: true })\n    );\n  };\n\n  const currentTab = getCurrentTab();\n  return (\n    <Layout\n      tabs={tabs}\n      homepage={false}\n      theme={theme}\n      pageTitle={title}\n      pageDescription={description}\n      pageKeywords={keywords}\n      titleType={titleType}\n    >\n      <PageHeader title={Title ? <Title /> : title} label=\"label\" tabs={tabs} />\n      {tabs && <PageTabs slug={slug} tabs={tabs} currentTab={currentTab} />}\n      <Main padded>\n        {children}\n        <EditLink relativePagePath={relativePagePath} />\n      </Main>\n      <NextPrevious\n        pageContext={pageContext}\n        location={location}\n        slug={slug}\n        tabs={tabs}\n        currentTab={currentTab}\n      />\n      <BackToTopBtn />\n    </Layout>\n  );\n};\n\nexport default Default;\n","import React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nimport DefaultLayout from \"/home/travis/build/ibm-cloud-architecture/cloudpak8s/node_modules/gatsby-theme-carbon/src/templates/Default.js\";\nexport const _frontmatter = {};\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1>{`Steps for EFK installation on OpenShift 4 on AWS`}</h1>\n    <p>{`We will demonstrate how to install the EFK on OpenShift 4 cluster. As we described, the Operator is a key technology for the day 2 operation in OCP 4. We use the Operators to enable the EFK stack. For demonstration purpose, we install the Elasticsearch Operator via the oc CLI and the Cluster Logging Operator via Web Console.  `}</p>\n    <h1>{`Install the Elasticsearch Operator`}</h1>\n    <p>{`As mentioned, we will show you how to install the Elasticsearch Operator via the CLI.`}</p>\n    <h2>{`Login to the OCP`}</h2>\n    <p>{`Log in to the OpenShift cluster with the oc login command. In the following execution example, enter `}<em parentName=\"p\">{`openshift api url`}</em>{` according to your environment.`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`$ oc login https://<openshift api url>:6443/\n`}</code></pre>\n    <p>{`Here is what we did in our cluster. Note that the value of -p which is the password of the user is not the actual one since I shouldn’t put the real one here.  We also use the user “kubeadmin” in our example but it is not recommended. Instead, you should use your own user.`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`$ oc login -u kubeadmin -p abcabcabc https://api.csmo1aws.privatedomain.ml:6443\nLogin successful.\n\nYou have access to 51 projects, the list has been suppressed. You can list all projects with 'oc projects'\n\nUsing project \"default\".\n$ \n`}</code></pre>\n    <h2>{`Create a namespace to create an Elasticsearch Operator`}</h2>\n    <p>{`First, prepare a manifest file to create a namespace for creating an Elasticsearch Operator. As an example, create the file as follow.`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`$ vi eo-namespace.yaml\n$ cat eo-namespace.yaml \napiVersion: v1\nkind: Namespace\nmetadata:\n  name: openshift-operators-redhat\n  annotations:\n    openshift.io/node-selector: \"\"\n  labels:\n    openshift.io/cluster-logging: \"true\"\n    openshift.io/cluster-monitoring: \"true\"\n$  \n`}</code></pre>\n    <p>{`Note that you can specify any namespace name for the value of “name:“.  In our example, we specify “openshift-operators-redhat”.`}</p>\n    <p>{`Then create a namespace with the yaml file by runing the oc create command as follow.`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`$ oc create -f eo-namespace.yaml\nnamespace/openshift-operators-redhat created\n$  \n`}</code></pre>\n    <h2>{`Create a namespace to create a Cluster Logging Operator`}</h2>\n    <p>{`Prepare a manifest file to create a namespace to create a Cluster Logging Operator. As an example, create the file as follow.`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`$ vi clo-namespace.yaml\n$ cat clo-namespace.yaml \napiVersion: v1\nkind: Namespace\nmetadata:\n  name: openshift-logging\n  annotations:\n    openshift.io/node-selector: \"\"\n  labels:\n    openshift.io/cluster-logging: \"true\"\n    openshift.io/cluster-monitoring: \"true\"\n$ \n`}</code></pre>\n    <p>{`Note that you can specify any namespace name for the value of “name:“.  In our example, we specify “openshift-logging”.`}</p>\n    <p>{`Then create a namespace with the yaml file by runing the oc create command as follow.`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`$ oc create -f clo-namespace.yaml\nnamespace/openshift-logging created\n$ \n`}</code></pre>\n    <h2>{`Install the Elasticsearch Operator`}</h2>\n    <p>{`Prepare an Operator Group resource for Elasticsearch as follow.`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`$ vi eo-og.yaml\n$ cat eo-og.yaml \napiVersion: operators.coreos.com/v1\nkind: OperatorGroup\nmetadata:\n  name: openshift-operators-redhat\n  namespace: openshift-operators-redhat\nspec: {}\n$ \n`}</code></pre>\n    <p>{`Note that for the value of the “namespace:”, specify the namespace created for the Elasticsearch Operator namespace in the previous step.  In our example, we specify “openshift-operators-redhat”.`}</p>\n    <p>{`Then, create an Operator Group via oc create command as follow.`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`$ oc create -f eo-og.yaml\noperatorgroup.operators.coreos.com/openshift-operators-redhat created\n$ \n`}</code></pre>\n    <p>{`Use the oc get command to check the channel name for subscribing the Operator. In the following execution example, you can confirm that the channel name is 4.2.`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`$ oc get packagemanifest elasticsearch-operator -n openshift-marketplace -o jsonpath='{.status.channels[].name}'\n4.2\n$\n`}</code></pre>\n    <p>{`The next step is to prepare the Subscription of the operator. Create a yaml file as follow.`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`$ vi eo-sub.yaml\n$ cat eo-sub.yaml \napiVersion: operators.coreos.com/v1alpha1\nkind: Subscription\nmetadata:\n  generateName: \"elasticsearch-\"\n  namespace: \"openshift-operators-redhat\"\nspec:\n  channel: \"4.2\"\n  installPlanApproval: \"Automatic\"\n  source: \"redhat-operators\"\n  sourceNamespace: \"openshift-marketplace\"\n  name: \"elasticsearch-operator\"\n$ \n`}</code></pre>\n    <p>{`Note that for the value of “namespace:”, specify the one created in the previous step. In our example, we specify “openshift-operators-redhat”.`}</p>\n    <p>{`With the yaml file, you create the subscription by issuing the oc create command as follow.`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`$ oc create -f eo-sub.yaml\nsubscription.operators.coreos.com/elasticsearch-724cq created\n$ \n`}</code></pre>\n    <p>{`Change the current namespace by oc project command as follow.`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`$ oc project openshift-operators-redhat\nNow using project \"openshift-operators-redhat\" on server \"https://api.csmo1aws.privatedomain.ml:6443\".\n$  \n`}</code></pre>\n    <p>{`As the final step for the Elasticsearch operator installation, prepare an Operator RBAC object. Create the eo-rbac.yaml file as follow.`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`$ vi eo-rbac.yaml\n$ cat eo-rbac.yaml \napiVersion: rbac.authorization.k8s.io/v1\nkind: Role\nmetadata:\n  name: prometheus-k8s\n  namespace: openshift-operators-redhat\nrules:\n- apiGroups:\n  - \"\"\n  resources:\n  - services\n  - endpoints\n  - pods\n  verbs:\n  - get\n  - list\n  - watch\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: RoleBinding\nmetadata:\n  name: prometheus-k8s\n  namespace: openshift-operators-redhat\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: Role\n  name: prometheus-k8s\nsubjects:\n- kind: ServiceAccount\n  name: prometheus-k8s\n  namespace: openshift-operators-redhat\n$ \n`}</code></pre>\n    <p>{`Then, create an RBAC object using the oc create command as follow.`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`$ oc create -f eo-rbac.yaml\nrole.rbac.authorization.k8s.io/prometheus-k8s created\nrolebinding.rbac.authorization.k8s.io/prometheus-k8s created\n$ \n`}</code></pre>\n    <p>{`Now, the Elasticsearch Operator installation is complete. Confirm that it is installed with the oc get command.`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`$ oc get pod -n openshift-operators-redhat\nNAME                                      READY   STATUS    RESTARTS   AGE\nelasticsearch-operator-8664584cbc-wq57s   1/1     Running   0          2m16s\n$ \n`}</code></pre>\n    <h2>{`Install the Cluster Logging Operator`}</h2>\n    <p>{`Login with the OpenShift Web console and expand the `}<strong parentName=\"p\">{`Operator`}</strong>{` → `}<strong parentName=\"p\">{`OperatorHub`}</strong>{` menu.\nSearch for and select the Operator named “Cluster Logging” as shown in the following figure.  `}</p>\n    <img {...{\n      \"src\": \"/assets/img/day2/cluster_logging_operator_1_aws.png\",\n      \"alt\": \"cluster_logging_operator_1\"\n    }}></img>\n    <p>{`Click the `}<strong parentName=\"p\">{`Install`}</strong>{` button in the `}<strong parentName=\"p\">{`Cluster Logging`}</strong>{` dialog displayed on the screen as shown in below.  `}</p>\n    <img {...{\n      \"src\": \"/assets/img/day2/cluster_logging_operator_2_aws.png\",\n      \"alt\": \"cluster_logging_operator_2\"\n    }}></img>\n    <p>{`On the `}<strong parentName=\"p\">{`Create Operator Subscription`}</strong>{` screen, select `}<strong parentName=\"p\">{`openshift-logging`}</strong>{` created in the previous step from the namespace drop-down list, and click the `}<strong parentName=\"p\">{`Subscribe`}</strong>{` button.`}</p>\n    <img {...{\n      \"src\": \"/assets/img/day2/cluster_logging_operator_3_aws.png\",\n      \"alt\": \"cluster_logging_operator_3\"\n    }}></img>\n    <p>{`Now, we complete the `}<strong parentName=\"p\">{`Cluster Logging Operator`}</strong>{` installation steps.`}</p>\n    <h2>{`Checking Operator installation status`}</h2>\n    <p>{`Up to this point, installation of Elasticsearch Operator and Cluster Logging Operator has been completed. Check if each Operator has been installed correctly.`}</p>\n    <h3>{`Check Cluster Logging Operator`}</h3>\n    <p>{`Select `}<strong parentName=\"p\">{`Operators`}</strong>{` -> `}<strong parentName=\"p\">{`Installed Operators`}</strong>{` from the Web console. At this time, perform the operation with the Project `}<strong parentName=\"p\">{`openshift-logging`}</strong>{` that the project where the `}<strong parentName=\"p\">{`Cluster Logging`}</strong>{` Operator is installed.`}</p>\n    <img {...{\n      \"src\": \"/assets/img/day2/cluster_logging_operator_4_aws.png\",\n      \"alt\": \"cluster_logging_operator_4\"\n    }}></img>\n    <p>{`On the Installed Operators page, check the `}<strong parentName=\"p\">{`Cluster Logging`}</strong>{` operator and find out its status which is `}<strong parentName=\"p\">{`InstallSucceeded`}</strong>{`.`}</p>\n    <h3>{`Check Elasticsearch Operator`}</h3>\n    <p>{`Change the Project selection at the top of the center of the screen to the namespace where the `}<strong parentName=\"p\">{`Elasticsearch Operator`}</strong>{` is installed.  In our example, it is `}<strong parentName=\"p\">{`openshift-opeartors-redhat`}</strong>{` as shown in below.`}</p>\n    <img {...{\n      \"src\": \"/assets/img/day2/cluster_logging_operator_5_aws.png\",\n      \"alt\": \"cluster_logging_operator_5\"\n    }}></img>\n    <p>{`On the Installed Operators page, check the `}<strong parentName=\"p\">{`Elasticsearch`}</strong>{` operator and find out its status which is `}<strong parentName=\"p\">{`InstallSucceeded`}</strong>{`.`}</p>\n    <p>{`If there is no problem in any of the displays, you have confirmed the installation of Operators.`}</p>\n    <h2>{`Creating a Cluster Logging instance`}</h2>\n    <p>{`From here, we will create a Pod that will be the substance of Cluster Logging.`}</p>\n    <h3>{`Define Custom Resource Definition（CRD）`}</h3>\n    <p>{`Select `}<strong parentName=\"p\">{`Administration`}</strong>{` -> `}<strong parentName=\"p\">{`Custom Resource Definitions`}</strong>{` from the Web console.\nEnter a string such as `}<strong parentName=\"p\">{`ClusterLogging`}</strong>{` in the filter at the top right of the screen. The `}<strong parentName=\"p\">{`ClusterLogging`}</strong>{` CRD is displayed. Then, click on `}<strong parentName=\"p\">{`ClusterLogging`}</strong>{`.`}</p>\n    <img {...{\n      \"src\": \"/assets/img/day2/cluster_logging_operator_6_aws.png\",\n      \"alt\": \"cluster_logging_operator_6\"\n    }}></img>\n    <p>{`On the `}<strong parentName=\"p\">{`Custom Resource Definition Details`}</strong>{` page, the `}<strong parentName=\"p\">{`Overview`}</strong>{` tab of the CRD `}<strong parentName=\"p\">{`clusterloggings.logging.openshift.io`}</strong>{` is displayed.\nNext, select `}<strong parentName=\"p\">{`View Instances`}</strong>{` from the `}<strong parentName=\"p\">{`Actions`}</strong>{` drop-down list in the upper right.`}</p>\n    <img {...{\n      \"src\": \"/assets/img/day2/cluster_logging_operator_7_aws.png\",\n      \"alt\": \"cluster_logging_operator_7\"\n    }}></img>\n    <p>{`The `}<strong parentName=\"p\">{`Cluster Loggings`}</strong>{` page is displayed. `}</p>\n    <img {...{\n      \"src\": \"/assets/img/day2/cluster_logging_operator_8_aws.png\",\n      \"alt\": \"cluster_logging_operator_8\"\n    }}></img>\n    <p>{`Click the `}<strong parentName=\"p\">{`Create Cluster Logging`}</strong>{` button to open the edit screen of yaml for creating an instance and enter the following contents.`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`apiVersion: \"logging.openshift.io/v1\"\nkind: \"ClusterLogging\"\nmetadata:\n  name: \"instance\"\n  namespace: \"openshift-logging\"\nspec:\n  managementState: \"Managed\"\n  logStore:\n    type: \"elasticsearch\"\n    elasticsearch:\n      nodeCount: 3\n      storage:\n        storageClassName: gp2\n        size: 200G\n      redundancyPolicy: \"SingleRedundancy\"\n  visualization:\n    type: \"kibana\"\n    kibana:\n      replicas: 1\n  curation:\n    type: \"curator\"\n    curator:\n      schedule: \"30 3 * * *\"\n  collection:\n    logs:\n      type: \"fluentd\"\n      fluentd: {}\n`}</code></pre>\n    <p>{`After entering, press the `}<strong parentName=\"p\">{`Create`}</strong>{` button.  `}</p>\n    <img {...{\n      \"src\": \"/assets/img/day2/cluster_logging_operator_9_aws.png\",\n      \"alt\": \"cluster_logging_operator_9\"\n    }}></img>\n    <p>{`Note that the default OpenShift cluster installation settings on AWS (IPI) does not have enough resources on workers. Therefore, we got the following errors on the OpenShift dashboard.\n`}<img parentName=\"p\" {...{\n        \"src\": \"/assets/img/day2/cluster_logging_operator_10_aws.png\",\n        \"alt\": \"cluster_logging_operator_10\"\n      }}></img>{`\nYou may also see that the PVC for the Elasticsearch logging are pending on the dashboard.`}</p>\n    <p>{`To solve this resouce shortage issues, we changed the worker nodes size from m4.large to m4.2xlarge.\nFYI. We tried m4.xlarge but it didn’t large enough.\nHere are the commands we used to upgrade the worker nodes size.`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`$ oc get machines -n openshift-machine-api\nNAME                                     STATE     TYPE        REGION      ZONE         AGE\ncsmo1aws-fsdjv-master-0                  running   m4.xlarge   us-west-1   us-west-1b   5d12h\ncsmo1aws-fsdjv-master-1                  running   m4.xlarge   us-west-1   us-west-1c   5d12h\ncsmo1aws-fsdjv-master-2                  running   m4.xlarge   us-west-1   us-west-1b   5d12h\ncsmo1aws-fsdjv-worker-us-west-1b-gx8d2   running   m4.xlarge   us-west-1   us-west-1b   2d23h\ncsmo1aws-fsdjv-worker-us-west-1c-5sr2w   running   m4.xlarge   us-west-1   us-west-1c   2d23h\ncsmo1aws-fsdjv-worker-us-west-1c-x8gxr   running   m4.xlarge   us-west-1   us-west-1c   2d23h\n$\n\n$ oc patch machineset csmo1aws-fsdjv-worker-us-west-1b --type='merge' --patch='{\"spec\": { \"template\": { \"spec\": { \"providerSpec\": { \"value\": { \"instanceType\": \"m4.2xlarge\"}}}}}}' -n openshift-machine-api\nmachineset.machine.openshift.io/csmo1aws-fsdjv-worker-us-west-1b patched\n$ \n\n$ oc patch machineset csmo1aws-fsdjv-worker-us-west-1c --type='merge' --patch='{\"spec\": { \"template\": { \"spec\": { \"providerSpec\": { \"value\": { \"instanceType\": \"m4.2xlarge\"}}}}}}' -n openshift-machine-api\nmachineset.machine.openshift.io/csmo1aws-fsdjv-worker-us-west-1c patched\n$ \n\n$ oc scale machineset csmo1aws-fsdjv-worker-us-west-1b --replicas=0 -n openshift-machine-api\nmachineset.machine.openshift.io/csmo1aws-fsdjv-worker-us-west-1b scaled\n$ \n\n$ oc scale machineset csmo1aws-fsdjv-worker-us-west-1b --replicas=1 -n openshift-machine-api\nmachineset.machine.openshift.io/csmo1aws-fsdjv-worker-us-west-1b scaled\n$\n\n$ oc scale machineset csmo1aws-fsdjv-worker-us-west-1c --replicas=0 -n openshift-machine-api\nmachineset.machine.openshift.io/csmo1aws-fsdjv-worker-us-west-1c scaled\n$ \n\n$ oc scale machineset csmo1aws-fsdjv-worker-us-west-1b --replicas=2 -n openshift-machine-api\nmachineset.machine.openshift.io/csmo1aws-fsdjv-worker-us-west-1b scaled\n$\n\n$ oc scale machineset csmo1aws-fsdjv-worker-us-west-1c --replicas=1 -n openshift-machine-api\nmachineset.machine.openshift.io/csmo1aws-fsdjv-worker-us-west-1c scaled\n$\n\n$ oc get machinesets -n openshift-machine-api\nNAME                               DESIRED   CURRENT   READY   AVAILABLE   AGE\ncsmo1aws-fsdjv-worker-us-west-1b   2         2         2       2           5d13h\ncsmo1aws-fsdjv-worker-us-west-1c   1         1         1       1           5d13h\n$\n\n$ oc get machines -n openshift-machine-api\nNAME                                     STATE     TYPE         REGION      ZONE         AGE\ncsmo1aws-fsdjv-master-0                  running   m4.xlarge    us-west-1   us-west-1b   5d13h\ncsmo1aws-fsdjv-master-1                  running   m4.xlarge    us-west-1   us-west-1c   5d13h\ncsmo1aws-fsdjv-master-2                  running   m4.xlarge    us-west-1   us-west-1b   5d13h\ncsmo1aws-fsdjv-worker-us-west-1b-bwxw7   running   m4.2xlarge   us-west-1   us-west-1b   18m\ncsmo1aws-fsdjv-worker-us-west-1b-s6wsb   running   m4.2xlarge   us-west-1   us-west-1b   7m45s\ncsmo1aws-fsdjv-worker-us-west-1c-cf9r2   running   m4.2xlarge   us-west-1   us-west-1c   7m\n$ \n\n$ oc get nodes\nNAME                                         STATUS   ROLES    AGE     VERSION\nip-10-0-129-227.us-west-1.compute.internal   Ready    master   5d13h   v1.14.6+cebabbf4a\nip-10-0-138-212.us-west-1.compute.internal   Ready    worker   4m23s   v1.14.6+cebabbf4a\nip-10-0-139-19.us-west-1.compute.internal    Ready    master   5d13h   v1.14.6+cebabbf4a\nip-10-0-141-88.us-west-1.compute.internal    Ready    worker   15m     v1.14.6+cebabbf4a\nip-10-0-151-108.us-west-1.compute.internal   Ready    master   5d13h   v1.14.6+cebabbf4a\nip-10-0-158-42.us-west-1.compute.internal    Ready    worker   4m11s   v1.14.6+cebabbf4a\n$\n`}</code></pre>\n    <p>{`As a result, several components of EFK stack are created inside OpenShift.\nExecute the oc get command to confirm that the pod STATUS is `}<strong parentName=\"p\">{`Running`}</strong>{`.`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`$ oc get pod -n openshift-logging\nNAME                                            READY   STATUS    RESTARTS   AGE\ncluster-logging-operator-697dbb7bf9-dhjpc       1/1     Running   0          23m\nelasticsearch-cdm-9whip7ih-1-5846879467-mlmdw   2/2     Running   0          15m\nelasticsearch-cdm-9whip7ih-2-7b8f4bd55f-cb5cg   2/2     Running   0          14m\nelasticsearch-cdm-9whip7ih-3-b4c87df67-znw9x    2/2     Running   0          13m\nfluentd-2smx6                                   1/1     Running   6          4d23h\nfluentd-fgkhp                                   1/1     Running   6          4d23h\nfluentd-j6bnb                                   1/1     Running   0          30m\nfluentd-m82q2                                   1/1     Running   0          18m\nfluentd-td72t                                   1/1     Running   6          4d23h\nfluentd-z5h4j                                   1/1     Running   0          18m\nkibana-bc9b88996-7fh5r                          2/2     Running   0          23m\n$ \n`}</code></pre>\n    <p>{`You can find that the status of PVC on the dashboard became `}<strong parentName=\"p\">{`Bound`}</strong>{` as shown in the following picture.\n`}<img parentName=\"p\" {...{\n        \"src\": \"/assets/img/day2/cluster_logging_operator_11_aws.png\",\n        \"alt\": \"cluster_logging_operator_11\"\n      }}></img></p>\n    <h2>{`Access Kibana Dashboard`}</h2>\n    <p>{`Access the created Kibana web console. You can check the public URL of Kibata from the `}{`[Networking]`}{`-> `}{`[Routes]`}{` menu of the OpenShift web console or by using the oc get route command.`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`$ oc get route -n openshift-logging\nNAME     HOST/PORT                                                 PATH   SERVICES   PORT    TERMINATION          WILDCARD\nkibana   kibana-openshift-logging.apps.csmo1aws.privatedomain.ml          kibana     <all>   reencrypt/Redirect   None\n$ \n`}</code></pre>\n    <p>{`The HOST / PORT for the `}<strong parentName=\"p\">{`oc get route`}</strong>{` command output will be the URL of the Kibana web console. You can also access the Kibana web console from OpenShift dashboard by navigating Administrator —> Monitoring —> Logging.  Note that the `}<strong parentName=\"p\">{`Logging`}</strong>{` option will not be shown until you configured the EFK on your OpenShift. In other words, by default, you don’t see it on the menu.\nIf you can access it normally, the Kibana dashboard will be displayed and you can see that the log messages output on the OpenShiftCluster node are being collected as shown in below.`}</p>\n    <img {...{\n      \"src\": \"/assets/img/day2/cluster_logging_operator_12_aws.png\",\n      \"alt\": \"cluster_logging_operator_12\"\n    }}></img>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"sourceRoot":""}