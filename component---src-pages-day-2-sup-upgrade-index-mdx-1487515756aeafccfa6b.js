(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{"013z":function(e,t,a){"use strict";a("KKXr"),a("pIFo");var n=a("pOBw"),r=a("q1tI"),o=a.n(r),l=a("NmYn"),b=a.n(l),p=a("OKom"),c=a("k4MR"),i=a("TSYQ"),s=a.n(i),u=a("QH2O"),h=a("qKvR"),d=function(e){var t,a=e.title,n=e.tabs,r=void 0===n?[]:n;return Object(h.b)("div",{className:s()(u.pageHeader,(t={},t[u.withTabs]=r.length,t))},Object(h.b)("div",{className:"bx--grid"},Object(h.b)("div",{className:"bx--row"},Object(h.b)("div",{className:"bx--col-lg-12"},Object(h.b)("h1",{id:"page-title",className:u.text},a)))))},m=a("pEPl"),O=a("BAC9"),j=function(e){var t=e.relativePagePath,a=e.repository,n=m.data.site.siteMetadata.repository,r=a||n,o=r.baseUrl,l=r.subDirectory,b=o+"/edit/"+r.branch+l+"/src/pages"+t;return o?Object(h.b)("div",{className:"bx--row "+O.row},Object(h.b)("div",{className:"bx--col"},Object(h.b)("a",{className:O.link,href:b},"Edit this page on GitHub"))):null},g=a("FCXl"),N=(a("Oyvg"),a("Wbzz")),w=a("I8xM");var f=function(e){var t,a;function n(){return e.apply(this,arguments)||this}return a=e,(t=n).prototype=Object.create(a.prototype),t.prototype.constructor=t,t.__proto__=a,n.prototype.render=function(){var e=this.props,t=e.tabs,a=e.slug,n=a.split("/").filter(Boolean).slice(-1)[0],r=t.map((function(e){var t,r=b()(e,{lower:!0}),o=r===n,l=new RegExp(n+"(?!-)"),p=a.replace(l,r);return Object(h.b)("li",{key:e,className:s()((t={},t[w.selectedItem]=o,t),w.listItem)},Object(h.b)(N.Link,{className:w.link,to:""+p},e))}));return Object(h.b)("div",{className:w.tabsContainer},Object(h.b)("div",{className:"bx--grid"},Object(h.b)("div",{className:"bx--row"},Object(h.b)("div",{className:"bx--col-lg-12 bx--col-no-gutter"},Object(h.b)("nav",null,Object(h.b)("ul",{className:w.list},r))))))},n}(o.a.Component),v=a("MjG9");t.a=function(e){var t=e.pageContext,a=e.children,r=e.location,o=e.Title,l=t.frontmatter,i=void 0===l?{}:l,s=t.relativePagePath,u=t.titleType,m=i.tabs,O=i.title,N=i.theme,w=i.description,k=i.keywords,C=n.data.site.pathPrefix,y=C?r.pathname.replace(C,""):r.pathname,x=m?y.split("/").filter(Boolean).slice(-1)[0]||b()(m[0],{lower:!0}):"";return Object(h.b)(c.a,{tabs:m,homepage:!1,theme:N,pageTitle:O,pageDescription:w,pageKeywords:k,titleType:u},Object(h.b)(d,{title:o?Object(h.b)(o,null):O,label:"label",tabs:m}),m&&Object(h.b)(f,{slug:y,tabs:m,currentTab:x}),Object(h.b)(v.a,{padded:!0},a,Object(h.b)(j,{relativePagePath:s})),Object(h.b)(g.a,{pageContext:t,location:r,slug:y,tabs:m,currentTab:x}),Object(h.b)(p.a,null))}},MHUb:function(e,t,a){"use strict";a.r(t),a.d(t,"_frontmatter",(function(){return l})),a.d(t,"default",(function(){return c}));a("91GP"),a("rGqo"),a("yt8O"),a("Btvt"),a("RW0V"),a("q1tI");var n=a("7ljp"),r=a("013z");a("qKvR");function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var l={},b={_frontmatter:l},p=r.a;function c(e){var t=e.components,a=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,["components"]);return Object(n.b)(p,o({},b,a,{components:t,mdxType:"MDXLayout"}),Object(n.b)("h1",null,"OpenShift Container Platform (OCP) 4 upgrade paths"),Object(n.b)("p",null,"In Red Hat Knowledgebase, there is an article which talk about the OCP upgrade paths.",Object(n.b)("br",{parentName:"p"}),"\n",Object(n.b)("a",o({parentName:"p"},{href:"https://access.redhat.com/solutions/4583231"}),"OpenShift Container Platform (OCP) 4 upgrade paths: 4583231")),Object(n.b)("blockquote",null,Object(n.b)("p",{parentName:"blockquote"},"Issue:",Object(n.b)("br",{parentName:"p"}),"\n","What are the upgrade paths in OpenShift 4?",Object(n.b)("br",{parentName:"p"}),"\n","How to upgrade to the next minor version of OpenShift 4?")),Object(n.b)("p",null,"In this document, we will demonstrate how you can find out the upgrade paths based on the knowledgebase information."),Object(n.b)("h2",null,"Preparation"),Object(n.b)("p",null,"Before we dive into deeper, we will talk about preparation you need to do.",Object(n.b)("br",{parentName:"p"}),"\n","To follow the instructions in the knowledgebase, there are several tools we need to install on our environment.",Object(n.b)("br",{parentName:"p"}),"\n","For this demonstration, we use macOS Catalina 10.15.4 on our laptop.",Object(n.b)("br",{parentName:"p"}),"\n","Here are the commands we needed to install on our macOS."),Object(n.b)("ul",null,Object(n.b)("li",{parentName:"ul"},"jq"),Object(n.b)("li",{parentName:"ul"},"dot"),Object(n.b)("li",{parentName:"ul"},"graph.sh")),Object(n.b)("p",null,"We also needed to install ",Object(n.b)("inlineCode",{parentName:"p"},"brew")," command to install ",Object(n.b)("inlineCode",{parentName:"p"},"jq")," and ",Object(n.b)("inlineCode",{parentName:"p"},"dot")," commands"),Object(n.b)("p",null,"Here is the commands we executed to install ",Object(n.b)("inlineCode",{parentName:"p"},"brew")," command."),Object(n.b)("pre",null,Object(n.b)("code",o({parentName:"pre"},{}),'/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install.sh)"\n')),Object(n.b)("p",null,"Once we successfully installed the brew command (a.k.a. Homebrew), then we installed the ",Object(n.b)("inlineCode",{parentName:"p"},"jq")," command."),Object(n.b)("pre",null,Object(n.b)("code",o({parentName:"pre"},{}),"brew install jq\n")),Object(n.b)("p",null,"Then, we installed ",Object(n.b)("inlineCode",{parentName:"p"},"dot")," command.  Note that the graphviz includes the ",Object(n.b)("inlineCode",{parentName:"p"},"dot")," command."),Object(n.b)("pre",null,Object(n.b)("code",o({parentName:"pre"},{}),"brew install graphviz\n")),Object(n.b)("p",null,"One more thing we needed to installed is that the ",Object(n.b)("inlineCode",{parentName:"p"},"graph.sh"),"."),Object(n.b)("blockquote",null,Object(n.b)("p",{parentName:"blockquote"},"First, download the available graph.sh file: ",Object(n.b)("a",o({parentName:"p"},{href:"https://github.com/openshift/cincinnati/blob/master/hack/graph.sh."}),"https://github.com/openshift/cincinnati/blob/master/hack/graph.sh."))),Object(n.b)("p",null,"Now, we got everything we need to follow the instructions in the knowledgebase."),Object(n.b)("h2",null,"Listing the available upgrade paths"),Object(n.b)("p",null,"In the knowledgebase, there are two ways to find out the upgrade paths introduced.  "),Object(n.b)("h2",null,"Listing upgrade paths with a text"),Object(n.b)("p",null,"The upgrade path from a current version to the next available version can be found by using curl command."),Object(n.b)("p",null,"We will export the CURRENT_VERSION and CHANNEL_NAME variables before we execute the curl command as follow."),Object(n.b)("pre",null,Object(n.b)("code",o({parentName:"pre"},{}),"kenueno@kenuenoMacBook-Pro OCP4_upgrade_paths % export CURRENT_VERSION=4.3.12\nkenueno@kenuenoMacBook-Pro OCP4_upgrade_paths % export CHANNEL_NAME=stable-4.4\n")),Object(n.b)("p",null,"I the above example, we specified “4.3.12” as our current OCP cluster version.",Object(n.b)("br",{parentName:"p"}),"\n","Then, we specified “stable-4.4” channel for the target version.  "),Object(n.b)("p",null,"Now, we are ready to run the curl command as follow.  "),Object(n.b)("pre",null,Object(n.b)("code",o({parentName:"pre"},{}),'kenueno@kenuenoMacBook-Pro OCP4_upgrade_paths % curl -sH \'Accept:application/json\' "https://api.openshift.com/api/upgrades_info/v1/graph?channel=${CHANNEL_NAME}" | jq -r --arg CURRENT_VERSION "${CURRENT_VERSION}" \'. as $graph | $graph.nodes | map(.version==\'\\"$CURRENT_VERSION\\"\') | index(true) as $orig | $graph.edges | map(select(.[0] == $orig)[1]) | map($graph.nodes[.].version) | sort_by(.)\'\n[\n  "4.3.13",\n  "4.3.18",\n  "4.3.19",\n  "4.3.21"\n]\nkenueno@kenuenoMacBook-Pro OCP4_upgrade_paths %\n')),Object(n.b)("p",null,"In our case, the upgrade paths from “4.3.12” to “4.4” are “4.3.13”, “4.3.18”, “4.3.19” and “4.3.21” as shown above."),Object(n.b)("p",null,"Note that we used the ",Object(n.b)("inlineCode",{parentName:"p"},"jq")," command since it can easily extract values from JSON, aggregate them, and display them after formatting.  "),Object(n.b)("h2",null,"Listing upgrade paths with a dot graph"),Object(n.b)("p",null,"There is a way to show the upgrade paths with a ",Object(n.b)("inlineCode",{parentName:"p"},"dot")," grap.",Object(n.b)("br",{parentName:"p"}),"\n","A ",Object(n.b)("inlineCode",{parentName:"p"},"dot")," graph can be generated which may make it easier to understand the available upgrade paths.  "),Object(n.b)("p",null,"We also use the curl command and it will pipe the output to the ",Object(n.b)("inlineCode",{parentName:"p"},"graph.sh")," script, then pipe to the ",Object(n.b)("inlineCode",{parentName:"p"},"dot")," command to generate a graph as follow."),Object(n.b)("pre",null,Object(n.b)("code",o({parentName:"pre"},{}),"kenueno@kenuenoMacBook-Pro OCP4_upgrade_paths % curl -sH 'Accept:application/json' 'https://api.openshift.com/api/upgrades_info/v1/graph?channel=fast-4.4&arch=amd64' | ./graph.sh | dot -Tsvg > graph.svg\nkenueno@kenuenoMacBook-Pro OCP4_upgrade_paths % \n")),Object(n.b)("p",null,"Once the commands generated the graph, in our example above, it is called ",Object(n.b)("strong",{parentName:"p"},"graph.svg"),", we can take a look at the graph via a Web browser such as Safari, Chrome and Firefox as follow.  "),Object(n.b)("p",null,Object(n.b)("img",o({parentName:"p"},{src:"/assets/img/day2/ocp44_upgrade_path.png",alt:"ocp44_upgrade_path"}))," "),Object(n.b)("p",null,"The above output is for the stable-4.4 channel as of 2020-05-27.",Object(n.b)("br",{parentName:"p"}),"\n","Note that this output will most likely change at later dates, and is shown for demonstration purposes only."))}c.isMDXComponent=!0},pEPl:function(e){e.exports=JSON.parse('{"data":{"site":{"siteMetadata":{"repository":{"baseUrl":"https://github.com/ibm-cloud-architecture/cloudpak8s","subDirectory":"/","branch":"master"}}}}}')},pOBw:function(e){e.exports=JSON.parse('{"data":{"site":{"pathPrefix":""}}}')}}]);
//# sourceMappingURL=component---src-pages-day-2-sup-upgrade-index-mdx-1487515756aeafccfa6b.js.map