(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{"013z":function(e,n,t){"use strict";t("KKXr"),t("pIFo");var o=t("pOBw"),a=t("q1tI"),l=t.n(a),r=t("NmYn"),i=t.n(r),c=t("OKom"),s=t("k4MR"),p=t("TSYQ"),b=t.n(p),h=t("QH2O"),u=t("qKvR"),m=function(e){var n,t=e.title,o=e.tabs,a=void 0===o?[]:o;return Object(u.b)("div",{className:b()(h.pageHeader,(n={},n[h.withTabs]=a.length,n))},Object(u.b)("div",{className:"bx--grid"},Object(u.b)("div",{className:"bx--row"},Object(u.b)("div",{className:"bx--col-lg-12"},Object(u.b)("h1",{id:"page-title",className:h.text},t)))))},d=t("pEPl"),k=t("BAC9"),j=function(e){var n=e.relativePagePath,t=e.repository,o=d.data.site.siteMetadata.repository,a=t||o,l=a.baseUrl,r=a.subDirectory,i=l+"/edit/"+a.branch+r+"/src/pages"+n;return l?Object(u.b)("div",{className:"bx--row "+k.row},Object(u.b)("div",{className:"bx--col"},Object(u.b)("a",{className:k.link,href:i},"Edit this page on GitHub"))):null},O=t("FCXl"),f=(t("Oyvg"),t("Wbzz")),g=t("I8xM");var y=function(e){var n,t;function o(){return e.apply(this,arguments)||this}return t=e,(n=o).prototype=Object.create(t.prototype),n.prototype.constructor=n,n.__proto__=t,o.prototype.render=function(){var e=this.props,n=e.tabs,t=e.slug,o=t.split("/").filter(Boolean).slice(-1)[0],a=n.map((function(e){var n,a=i()(e,{lower:!0}),l=a===o,r=new RegExp(o+"(?!-)"),c=t.replace(r,a);return Object(u.b)("li",{key:e,className:b()((n={},n[g.selectedItem]=l,n),g.listItem)},Object(u.b)(f.Link,{className:g.link,to:""+c},e))}));return Object(u.b)("div",{className:g.tabsContainer},Object(u.b)("div",{className:"bx--grid"},Object(u.b)("div",{className:"bx--row"},Object(u.b)("div",{className:"bx--col-lg-12 bx--col-no-gutter"},Object(u.b)("nav",null,Object(u.b)("ul",{className:g.list},a))))))},o}(l.a.Component),w=t("MjG9");n.a=function(e){var n=e.pageContext,t=e.children,a=e.location,l=e.Title,r=n.frontmatter,p=void 0===r?{}:r,b=n.relativePagePath,h=n.titleType,d=p.tabs,k=p.title,f=p.theme,g=p.description,v=p.keywords,N=o.data.site.pathPrefix,A=N?a.pathname.replace(N,""):a.pathname,M=d?A.split("/").filter(Boolean).slice(-1)[0]||i()(d[0],{lower:!0}):"";return Object(u.b)(s.a,{tabs:d,homepage:!1,theme:f,pageTitle:k,pageDescription:g,pageKeywords:v,titleType:h},Object(u.b)(m,{title:l?Object(u.b)(l,null):k,label:"label",tabs:d}),d&&Object(u.b)(y,{slug:A,tabs:d,currentTab:M}),Object(u.b)(w.a,{padded:!0},t,Object(u.b)(j,{relativePagePath:b})),Object(u.b)(O.a,{pageContext:n,location:a,slug:A,tabs:d,currentTab:M}),Object(u.b)(c.a,null))}},Yr7H:function(e,n,t){"use strict";t.r(n),t.d(n,"_frontmatter",(function(){return r})),t.d(n,"default",(function(){return s}));t("91GP"),t("rGqo"),t("yt8O"),t("Btvt"),t("RW0V"),t("q1tI");var o=t("7ljp"),a=t("013z");t("qKvR");function l(){return(l=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e}).apply(this,arguments)}var r={},i={_frontmatter:r},c=a.a;function s(e){var n=e.components,t=function(e,n){if(null==e)return{};var t,o,a={},l=Object.keys(e);for(o=0;o<l.length;o++)t=l[o],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,["components"]);return Object(o.b)(c,l({},i,t,{components:n,mdxType:"MDXLayout"}),Object(o.b)("h1",null,"Helm 3 for OpenShift"),Object(o.b)("p",null,"You can find out many technical articles and blogs which talked about Helm on OpenShift.\nHelm is a package manager for Kubernetes that helps you more easily package, configure, and deploy applications onto Kubernetes clusters. OpenShift has been providing several deployment methods but Helm surprisingly."),Object(o.b)("p",null,"In OpenShift 4.3, Helm 3 for OpenShift Container Platform is introduced as a Technology Preview feature.　Yeah!"),Object(o.b)("p",null,"There is a bog which talked about this feature. We encourage you to read the blog to understand Helm on OpenShift.\n",Object(o.b)("a",l({parentName:"p"},{href:"https://blog.openshift.com/openshift-4-3-deploy-applications-with-helm-3/"}),"https://blog.openshift.com/openshift-4-3-deploy-applications-with-helm-3/")),Object(o.b)("p",null,"In this document, we will not exaplin the feature of Helm on Openshift.  Instead, we will demonstrate the feature by following the steps in the OpenShift official document.\nSince the official product document does not include the actual commands output (results of commands execution), we will include those for your reference.  Other than those sample output, you can find out most of information in the product official document."),Object(o.b)("p",null,Object(o.b)("a",l({parentName:"p"},{href:"https://docs.openshift.com/container-platform/4.3/cli_reference/helm_cli/getting-started-with-helm-on-openshift-container-platform.html"}),"https://docs.openshift.com/container-platform/4.3/cli_reference/helm_cli/getting-started-with-helm-on-openshift-container-platform.html")),Object(o.b)("h2",null,"Environment"),Object(o.b)("p",null,"For this document, we use OpenShift 4.3.5 on Azure (installed via IPI, not ARO).\nWe will install Helm on our laptop which is MacBook Air. The OS is Mojava (10.14.6)."),Object(o.b)("h2",null,"Installing Helm on Mac"),Object(o.b)("p",null,"There are two ways to install the Helm binary onto your laptop."),Object(o.b)("h3",null,"Installing Helm via CLI"),Object(o.b)("p",null,"The official document explains how to install Helm via CLI. For demonstration purposes, we will execute a few more commands than what the officail document said."),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},"Uninstall previous version of helm from the laptop\nIn our case, we unstall the helm 2 command which was installed previously to have a clean environment. If you don’t have helm installed, then you can skip this. If you want to keep the previous helm installation, please find out the way to have multiple installations (versions) and make sure that it will work.")),Object(o.b)("p",null,"Run ",Object(o.b)("strong",{parentName:"p"},"which")," command to find out if helm command is in the PATH."),Object(o.b)("pre",null,Object(o.b)("code",l({parentName:"pre"},{}),"kenuenonoMacBook-Air:~ kenueno$ which helm\n/usr/local/bin/helm\nkenuenonoMacBook-Air:~ kenueno$ \n")),Object(o.b)("p",null,"In out case, it’s in the /usr/local/bin and it’s Helm version 2. We ran ",Object(o.b)("strong",{parentName:"p"},"helm version")," command as below."),Object(o.b)("pre",null,Object(o.b)("code",l({parentName:"pre"},{}),'kenuenonoMacBook-Air:~ kenueno$ helm version\nClient: &version.Version{SemVer:"v2.9.1", GitCommit:"20adb27c7c5868466912eebdf6664e7390ebe710", GitTreeState:"clean"}\n')),Object(o.b)("p",null,"Then, we ran ",Object(o.b)("strong",{parentName:"p"},"brew list")," command to see if it’s installed via ",Object(o.b)("strong",{parentName:"p"},"brew")," as shown below."),Object(o.b)("pre",null,Object(o.b)("code",l({parentName:"pre"},{}),"kenuenonoMacBook-Air:~ kenueno$ brew list\nansible         bash-completion@2   helm                libnet              oniguruma       readline        xz\nasdf            certbot             icu4c               libtool             openssl         spruce          yarn\naugeas          coreutils           jmeter              libunistring        openssl@1.1     sqlite\nautoconf        dialog              jq                  libyaml             pkg-config      tcptraceroute\nautomake        dvm                 kubernetes-cli      maven               postgresql      tree\nazure-cli       gdbm                kubernetes-helm     minikube            python          unixodbc\nbash            gettext             libidn2             node                python@3.8      wget\nkenuenonoMacBook-Air:~ kenueno$\n")),Object(o.b)("p",null,"So, it’s installed via brew. Then, ran ",Object(o.b)("strong",{parentName:"p"},"brew uninstall")," command to delete helm version 2."),Object(o.b)("pre",null,Object(o.b)("code",l({parentName:"pre"},{}),"kenuenonoMacBook-Air:~ kenueno$ brew uninstall helm\nUninstalling /usr/local/Cellar/helm/2.9.1... (50 files, 66.2MB)\nkenuenonoMacBook-Air:~ kenueno$ \nkenuenonoMacBook-Air:~ kenueno$ brew uninstall kubernetes-helm\nError: No such keg: /usr/local/Cellar/helm\nkenuenonoMacBook-Air:~ kenueno$ \nkenuenonoMacBook-Air:~ kenueno$ brew list\nansible         bash                gdbm                libidn2             minikube        postgresql      tcptraceroute\nasdf            bash-completion@2   gettext             libnet              node            python          tree\naugeas          certbot             icu4c               libtool             oniguruma       python@3.8      unixodbc\nautoconf        coreutils           jmeter              libunistring        openssl         readline        wget\nautomake        dialog              jq                  libyaml             openssl@1.1     spruce          xz\nazure-cli       dvm                 kubernetes-cli      maven               pkg-config      sqlite          yarn\nkenuenonoMacBook-Air:~ kenueno$\n")),Object(o.b)("p",null,"As you see above, we ran ",Object(o.b)("strong",{parentName:"p"},"brew uninstall helm")," command and it deleted both ",Object(o.b)("strong",{parentName:"p"},"helm")," and ",Object(o.b)("strong",{parentName:"p"},"kubernetes-helm")," formulas."),Object(o.b)("p",null,"Before we install helm 3, make sure that helm 2 is removed from /usr/local/bin and it’s not in the PATH as follow."),Object(o.b)("pre",null,Object(o.b)("code",l({parentName:"pre"},{}),"kenuenonoMacBook-Air:~ kenueno$ ls -la /usr/local/bin/helm\nls: /usr/local/bin/helm: No such file or directory\nkenuenonoMacBook-Air:~ kenueno$ \nkenuenonoMacBook-Air:~ kenueno$ which helm\nkenuenonoMacBook-Air:~ kenueno$\n")),Object(o.b)("ol",{start:2},Object(o.b)("li",{parentName:"ol"},"Download the Helm binary and add it to your path\nNow, we will download the Helm 3 binary and put it into ",Object(o.b)("strong",{parentName:"li"},"/usr/local/bin")," folder.")),Object(o.b)("pre",null,Object(o.b)("code",l({parentName:"pre"},{}),"kenuenonoMacBook-Air:~ kenueno$ curl -L https://mirror.openshift.com/pub/openshift-v4/clients/helm/latest/helm-darwin-amd64 -o /usr/local/bin/helm\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100 41.4M  100 41.4M    0     0   653k      0  0:01:04  0:01:04 --:--:--  629k\nkenuenonoMacBook-Air:~ kenueno$ \n")),Object(o.b)("p",null,"Right after you download it to your laptop, it is not executable."),Object(o.b)("pre",null,Object(o.b)("code",l({parentName:"pre"},{}),"kenuenonoMacBook-Air:~ kenueno$ which helm\n")),Object(o.b)("ol",{start:3},Object(o.b)("li",{parentName:"ol"},"Make the binary file executable\nRun ",Object(o.b)("strong",{parentName:"li"},"chmod")," command to make the helm command executable as follow.")),Object(o.b)("pre",null,Object(o.b)("code",l({parentName:"pre"},{}),"kenuenonoMacBook-Air:~ kenueno$ sudo chmod +x /usr/local/bin/helm\nPassword:\nkenuenonoMacBook-Air:~ kenueno$ which helm\n/usr/local/bin/helm\nkenuenonoMacBook-Air:~ kenueno$ \n")),Object(o.b)("p",null,"As you see above, the ",Object(o.b)("strong",{parentName:"p"},"helm")," command is now in the PATH (/usr/local/bin) and excecutable."),Object(o.b)("ol",{start:4},Object(o.b)("li",{parentName:"ol"},"Check the installed version\nRun ",Object(o.b)("strong",{parentName:"li"},"helm version")," command as follow.")),Object(o.b)("pre",null,Object(o.b)("code",l({parentName:"pre"},{}),'kenuenonoMacBook-Air:~ kenueno$ helm version\nversion.BuildInfo{Version:"v3.1+unreleased", GitCommit:"7ebdbb86fca32c77f2fce166f7f9e58ebf7e9946", GitTreeState:"clean", GoVersion:"go1.13.4"}\nkenuenonoMacBook-Air:~ kenueno$ \n')),Object(o.b)("p",null,"As of writing this document, the latest version of the helm command from OpenShift site is v3.1 which is newer than what the official document said."),Object(o.b)("p",null,Object(o.b)("a",l({parentName:"p"},{href:"https://docs.openshift.com/container-platform/4.3/cli_reference/helm_cli/getting-started-with-helm-on-openshift-container-platform.html#on-macos"}),"https://docs.openshift.com/container-platform/4.3/cli_reference/helm_cli/getting-started-with-helm-on-openshift-container-platform.html#on-macos")),Object(o.b)("h3",null,"Installing Helm via OpenShift Web console"),Object(o.b)("p",null,"You can also intall the helm binary via OpenShift Web console."),Object(o.b)("p",null,"On the right-upper corner on the Web console, there is ”?” mark button.　Click that button and you will see the ",Object(o.b)("strong",{parentName:"p"},"Command Line Tools")," on the pull-down menu.\nClick on the ",Object(o.b)("strong",{parentName:"p"},"Command Line Tools")," then you will see ",Object(o.b)("strong",{parentName:"p"},"Command Line Tools")," page as shown in below."),Object(o.b)("img",{src:"/assets/img/day2/helm1.png",alt:"helm1",title:"Pull-down menu"}),Object(o.b)("p",null,"Click on ",Object(o.b)("strong",{parentName:"p"},"Download helm")," link as shown in below."),Object(o.b)("img",{src:"/assets/img/day2/helm2.png",alt:"helm2",title:"Command Line Tools Page"}),Object(o.b)("p",null,"Then you will got to the external openshift site where you can see the list of helm binary. Select the binary to download as shown in below. In our case, we select ",Object(o.b)("strong",{parentName:"p"},"helm-darwin-adm64")," for Mac.\n",Object(o.b)("img",l({parentName:"p"},{src:"/assets/img/day2/helm3.png",alt:"helm3",title:"List of Helm binary"}))),Object(o.b)("p",null,"Now, you have the helm 3 command on your laptop. In the following sections, we will demonstrate two senarios."),Object(o.b)("h2",null,"Installing a Helm chart on OpenShift"),Object(o.b)("p",null,"Let’s install your first Helm chart on OpenShift 4.3.5 cluster."),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"Make sure that you have helm 3 installed on your laptop (or where ever you would execute helm command)")),Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"Make sure that your OpenShift 4.3 cluster is up and running")),Object(o.b)("li",{parentName:"ol"},Object(o.b)("p",{parentName:"li"},"Log in to your OpenShift cluster via CLI\nIn our case, we use the token instead of the password with ",Object(o.b)("strong",{parentName:"p"},"oc login")," command as follow."))),Object(o.b)("pre",null,Object(o.b)("code",l({parentName:"pre"},{}),'kenuenonoMacBook-Air:~ kenueno$ oc login --token=xdacabababa_fVweYqG3Gisgeasgh4_hpRietebarfZaB --server=https://api.csmoazure1.csmoprivate.tk:6443\nThe server uses a certificate signed by an unknown authority.\nYou can bypass the certificate check, but any data you send to the server could be intercepted by others.\nUse insecure connections? (y/n): y\n\nLogged into "https://api.csmoazure1.csmoprivate.tk:6443" as "kenueno" using the token provided.\n\nYou have access to 54 projects, the list has been suppressed. You can list all projects with \'oc projects\'\n\nUsing project "default".\nkenuenonoMacBook-Air:~ kenueno$ \n')),Object(o.b)("ol",{start:4},Object(o.b)("li",{parentName:"ol"},"Create a new project\nRun ",Object(o.b)("strong",{parentName:"li"},"oc new-project")," command to create a new project.  In our case, the name of project is “mysql” as shown below.")),Object(o.b)("pre",null,Object(o.b)("code",l({parentName:"pre"},{}),'kenuenonoMacBook-Air:~ kenueno$ oc new-project mysql\nNow using project "mysql" on server "https://api.csmoazure1.csmoprivate.tk:6443".\n\nYou can add applications to this project with the \'new-app\' command. For example, try:\n\n    oc new-app django-psql-example\n\nto build a new example application in Python. Or use kubectl to deploy a simple Kubernetes application:\n\n    kubectl create deployment hello-node --image=gcr.io/hello-minikube-zero-install/hello-node\n\nkenuenonoMacBook-Air:~ kenueno$\n')),Object(o.b)("ol",{start:5},Object(o.b)("li",{parentName:"ol"},"Add a repository of Helm charts to your local Helm client\nRun ",Object(o.b)("strong",{parentName:"li"},"helm repo add")," command and here is the command usage:",Object(o.b)("blockquote",{parentName:"li"},Object(o.b)("p",{parentName:"blockquote"},"helm repo add ","[NAME][URL]"," ","[flags]")))),Object(o.b)("pre",null,Object(o.b)("code",l({parentName:"pre"},{}),'kenuenonoMacBook-Air:~ kenueno$ helm repo add stable https://kubernetes-charts.storage.googleapis.com/\n"stable" has been added to your repositories\nkenuenonoMacBook-Air:~ kenueno$ \n')),Object(o.b)("ol",{start:6},Object(o.b)("li",{parentName:"ol"},"Update the repository\nRun ",Object(o.b)("strong",{parentName:"li"},"helm repo update")," command.",Object(o.b)("blockquote",{parentName:"li"},Object(o.b)("p",{parentName:"blockquote"},"Update gets the latest information about charts from the respective chart repositories.\nInformation is cached locally, where it is used by commands like ‘helm search’.")))),Object(o.b)("pre",null,Object(o.b)("code",l({parentName:"pre"},{}),'kenuenonoMacBook-Air:~ kenueno$ helm repo update\nHang tight while we grab the latest from your chart repositories...\n...Successfully got an update from the "stable" chart repository\nUpdate Complete. ⎈ Happy Helming!⎈ \nkenuenonoMacBook-Air:~ kenueno$ \n')),Object(o.b)("p",null,"Make sure that you see “Happy Helming!” message as shown above."),Object(o.b)("ol",{start:7},Object(o.b)("li",{parentName:"ol"},"Install an example MySQL chart\nRun ",Object(o.b)("strong",{parentName:"li"},"helm install")," command.  Here is the usage of the command:",Object(o.b)("blockquote",{parentName:"li"},Object(o.b)("p",{parentName:"blockquote"}," helm install ","[NAME][CHART]"," ","[flags]")))),Object(o.b)("pre",null,Object(o.b)("code",l({parentName:"pre"},{}),'kenuenonoMacBook-Air:~ kenueno$ helm install example-mysql stable/mysql\nNAME: example-mysql\nLAST DEPLOYED: Wed Mar 18 00:19:38 2020\nNAMESPACE: mysql\nSTATUS: deployed\nREVISION: 1\nNOTES:\nMySQL can be accessed via port 3306 on the following DNS name from within your cluster:\nexample-mysql.mysql.svc.cluster.local\n\nTo get your root password run:\n\n    MYSQL_ROOT_PASSWORD=$(kubectl get secret --namespace mysql example-mysql -o jsonpath="{.data.mysql-root-password}" | base64 --decode; echo)\n\nTo connect to your database:\n\n1. Run an Ubuntu pod that you can use as a client:\n\n    kubectl run -i --tty ubuntu --image=ubuntu:16.04 --restart=Never -- bash -il\n\n2. Install the mysql client:\n\n    $ apt-get update && apt-get install mysql-client -y\n\n3. Connect using the mysql cli, then provide your password:\n    $ mysql -h example-mysql -p\n\nTo connect to your database directly from outside the K8s cluster:\n    MYSQL_HOST=127.0.0.1\n    MYSQL_PORT=3306\n\n    # Execute the following command to route the connection:\n    kubectl port-forward svc/example-mysql 3306\n\n    mysql -h ${MYSQL_HOST} -P${MYSQL_PORT} -u root -p${MYSQL_ROOT_PASSWORD}\nkenuenonoMacBook-Air:~ kenueno$\n')),Object(o.b)("ol",{start:8},Object(o.b)("li",{parentName:"ol"},"Verify that the chart has installed successfully\nRun ",Object(o.b)("strong",{parentName:"li"},"helm list")," command to verify that the chart “example-mysql” is installed.")),Object(o.b)("blockquote",null,Object(o.b)("p",{parentName:"blockquote"},"This command lists all of the releases for a specified namespace (uses current namespace context if namespace not specified).")),Object(o.b)("pre",null,Object(o.b)("code",l({parentName:"pre"},{}),"kenuenonoMacBook-Air:~ kenueno$ helm list\nNAME            NAMESPACE   REVISION    UPDATED                                 STATUS      CHART       APP VERSION\nexample-mysql   mysql       1           2020-03-18 00:19:38.477434 +0900 JST    deployed    mysql-1.6.2 5.7.28     \nkenuenonoMacBook-Air:~ kenueno$\n")),Object(o.b)("p",null,"You should see the chart “example-mysql” in the “mysql” namespace (= project)."),Object(o.b)("ol",{start:9},Object(o.b)("li",{parentName:"ol"},"Verity that the application is running on Web Console\nOn the OpenShift web console, you can verify that the application you installed via Helm is running.")),Object(o.b)("img",{src:"/assets/img/day2/helm4.png",alt:"helm4",title:"Web Console"}),Object(o.b)("img",{src:"/assets/img/day2/helm5.png",alt:"helm5",title:"Web Console"}),Object(o.b)("img",{src:"/assets/img/day2/helm6.png",alt:"helm6",title:"Web Console"}),Object(o.b)("p",null,Object(o.b)("a",l({parentName:"p"},{href:"https://docs.openshift.com/container-platform/4.3/cli_reference/helm_cli/getting-started-with-helm-on-openshift-container-platform.html#installing-a-helm-chart-on-an-openshift-cluster_getting-started-with-helm-on-openshift"}),"https://docs.openshift.com/container-platform/4.3/cli_reference/helm_cli/getting-started-with-helm-on-openshift-container-platform.html#installing-a-helm-chart-on-an-openshift-cluster_getting-started-with-helm-on-openshift")),Object(o.b)("h2",null,"Creating a custom Helm chart on OpenShift"),Object(o.b)("p",null,"Now, we will work on the second scenario."),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},"Create a new project\nWe will create another project called “nodejs-ex-k” as follow.")),Object(o.b)("pre",null,Object(o.b)("code",l({parentName:"pre"},{}),'kenuenonoMacBook-Air:~ kenueno$ cd RedHat/OpenShift/4.3/azure/\nkenuenonoMacBook-Air:azure kenueno$ pwd\n/Users/kenueno/RedHat/OpenShift/4.3/azure\nkenuenonoMacBook-Air:azure kenueno$ \nkenuenonoMacBook-Air:azure kenueno$ oc new-project nodejs-ex-k\nNow using project "nodejs-ex-k" on server "https://api.csmoazure1.csmoprivate.tk:6443".\n\nYou can add applications to this project with the \'new-app\' command. For example, try:\n\n    oc new-app django-psql-example\n\nto build a new example application in Python. Or use kubectl to deploy a simple Kubernetes application:\n\n    kubectl create deployment hello-node --image=gcr.io/hello-minikube-zero-install/hello-node\n\nkenuenonoMacBook-Air:azure kenueno$ \n')),Object(o.b)("ol",{start:2},Object(o.b)("li",{parentName:"ol"},"Download an example Node.js chart that contains OpenShift Container Platform objects\nFor this scenario, we will download a sample chart from the GitHub as shown below.")),Object(o.b)("pre",null,Object(o.b)("code",l({parentName:"pre"},{}),"kenuenonoMacBook-Air:azure kenueno$ git clone https://github.com/redhat-developer/redhat-helm-charts\nCloning into 'redhat-helm-charts'...\nremote: Enumerating objects: 61, done.\nremote: Counting objects: 100% (61/61), done.\nremote: Compressing objects: 100% (45/45), done.\nremote: Total 61 (delta 22), reused 42 (delta 11), pack-reused 0\nUnpacking objects: 100% (61/61), done.\nkenuenonoMacBook-Air:azure kenueno$\n")),Object(o.b)("ol",{start:3},Object(o.b)("li",{parentName:"ol"},"Go to the directory with the sample chart\nOnce you clone the git repo, move to the directory as shown below.")),Object(o.b)("pre",null,Object(o.b)("code",l({parentName:"pre"},{}),"kenuenonoMacBook-Air:azure kenueno$ cd redhat-helm-charts/alpha/nodejs-ex-k/\nkenuenonoMacBook-Air:nodejs-ex-k kenueno$ \nkenuenonoMacBook-Air:nodejs-ex-k kenueno$ pwd\n/Users/kenueno/RedHat/OpenShift/4.3/azure/redhat-helm-charts/alpha/nodejs-ex-k\nkenuenonoMacBook-Air:nodejs-ex-k kenueno$\n")),Object(o.b)("p",null,"Make sure that you are in the nodejs-ex-k directory."),Object(o.b)("ol",{start:4},Object(o.b)("li",{parentName:"ol"},"Edit the Chart.yaml file and add a description of your chart")),Object(o.b)("p",null,"Before we edit the Chart.yaml file, we make a copy and save it as Cart.yaml.org as follow. It’s not necessary step but it would be a good practice."),Object(o.b)("pre",null,Object(o.b)("code",l({parentName:"pre"},{}),"kenuenonoMacBook-Air:nodejs-ex-k kenueno$ ls -la Chart.yaml\n-rw-r--r--  1 kenueno  staff  909 Mar 18 00:22 Chart.yaml\nkenuenonoMacBook-Air:nodejs-ex-k kenueno$ \nkenuenonoMacBook-Air:nodejs-ex-k kenueno$ cp -p Chart.yaml Chart.yaml.org\n")),Object(o.b)("p",null,"Then we take a look at the Chart.yaml file."),Object(o.b)("pre",null,Object(o.b)("code",l({parentName:"pre"},{}),"kenuenonoMacBook-Air:nodejs-ex-k kenueno$ cat Chart.yaml\napiVersion: v2\nname: nodejs-ex-k\ndescription: A Helm chart for Kubernetes\n\n# A chart can be either an 'application' or a 'library' chart.\n#\n# Application charts are a collection of templates that can be packaged into versioned archives\n# to be deployed.\n#\n# Library charts provide useful utilities or functions for the chart developer. They're included as\n# a dependency of application charts to inject those utilities and functions into the rendering\n# pipeline. Library charts do not define any templates and therefore cannot be deployed.\ntype: application\n\n# This is the chart version. This version number should be incremented each time you make changes\n# to the chart and its templates, including the app version.\nversion: 0.1.0\n\n# This is the version number of the application being deployed. This version number should be\n# incremented each time you make changes to the application.\nappVersion: 1.16.0\nkenuenonoMacBook-Air:nodejs-ex-k kenueno$ \n")),Object(o.b)("p",null,"As the official document said, we will add the following four key and value pairs:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"The chart API version. It should be v2 for Helm charts that require at least Helm 3."),Object(o.b)("li",{parentName:"ul"},"The name of your chart."),Object(o.b)("li",{parentName:"ul"},"The description of your chart."),Object(o.b)("li",{parentName:"ul"},"The URL to an image to be used as an icon.")),Object(o.b)("p",null,"Here is what the official document said."),Object(o.b)("pre",null,Object(o.b)("code",l({parentName:"pre"},{}),"apiVersion: v2 \nname: nodejs-ex-k \ndescription: A Helm chart for OpenShift \nicon: https://static.redhat.com/libs/redhat/brand-assets/latest/corp/logo.svg\n")),Object(o.b)("p",null,"Here is how our Chart.yaml looks like."),Object(o.b)("pre",null,Object(o.b)("code",l({parentName:"pre"},{}),"kenuenonoMacBook-Air:nodejs-ex-k kenueno$ vi Chart.yaml\nkenuenonoMacBook-Air:nodejs-ex-k kenueno$ cat Chart.yaml\napiVersion: v2\nname: nodejs-ex-k\ndescription: A Helm chart for OpenShift \nicon: https://static.redhat.com/libs/redhat/brand-assets/latest/corp/logo.svg\n\n# A chart can be either an 'application' or a 'library' chart.\n#\n# Application charts are a collection of templates that can be packaged into versioned archives\n# to be deployed.\n#\n# Library charts provide useful utilities or functions for the chart developer. They're included as\n# a dependency of application charts to inject those utilities and functions into the rendering\n# pipeline. Library charts do not define any templates and therefore cannot be deployed.\n# type: application\n\n# This is the chart version. This version number should be incremented each time you make changes\n# to the chart and its templates, including the app version.\n# version: 0.1.0\n\n# This is the version number of the application being deployed. This version number should be\n# incremented each time you make changes to the application.\n# appVersion: 1.16.0\nkenuenonoMacBook-Air:nodejs-ex-k kenueno$ \n")),Object(o.b)("p",null,"As the OpenShift document said, we have 4 key and value paris and commented out rest of lines are commented out as shown above."),Object(o.b)("ol",{start:5},Object(o.b)("li",{parentName:"ol"},"Verify that the chart is formatted properly\nRun ",Object(o.b)("strong",{parentName:"li"},"helm lint")," command to very that the chart (Chart.yaml) you created is formatted properly.")),Object(o.b)("blockquote",null,Object(o.b)("p",{parentName:"blockquote"},"This command takes a path to a chart and runs a series of tests to verify that the chart is well-formed.\nIf the linter encounters things that will cause the chart to fail installation, it will emit ","[ERROR]"," messages. If it encounters issues that break with convention or recommendation, it will emit ","[WARNING]"," messages.")),Object(o.b)("pre",null,Object(o.b)("code",l({parentName:"pre"},{}),"kenuenonoMacBook-Air:nodejs-ex-k kenueno$ helm lint\n==> Linting .\n[ERROR] Chart.yaml: version is required\n[ERROR] templates/: validation: chart.metadata.version is required\n\nError: 1 chart(s) linted, 1 chart(s) failed\nkenuenonoMacBook-Air:nodejs-ex-k kenueno$ \n")),Object(o.b)("p",null,"Sigh…  We failed with an error message. It said “version is required”.  Oh no… We commented out the line “version: 0.1.0” in the Chart.yaml file since the OpenShift document didn’t mention it."),Object(o.b)("p",null,"We need to add (comment out, in fact) the version in the Chart.yaml file as follow."),Object(o.b)("pre",null,Object(o.b)("code",l({parentName:"pre"},{}),"kenuenonoMacBook-Air:nodejs-ex-k kenueno$ vi Chart.yaml\nkenuenonoMacBook-Air:nodejs-ex-k kenueno$ cat Chart.yaml\napiVersion: v2\nname: nodejs-ex-k\ndescription: A Helm chart for OpenShift \nicon: https://static.redhat.com/libs/redhat/brand-assets/latest/corp/logo.svg\n\n# A chart can be either an 'application' or a 'library' chart.\n#\n# Application charts are a collection of templates that can be packaged into versioned archives\n# to be deployed.\n#\n# Library charts provide useful utilities or functions for the chart developer. They're included as\n# a dependency of application charts to inject those utilities and functions into the rendering\n# pipeline. Library charts do not define any templates and therefore cannot be deployed.\n# type: application\n\n# This is the chart version. This version number should be incremented each time you make changes\n# to the chart and its templates, including the app version.\nversion: 0.1.0\n\n# This is the version number of the application being deployed. This version number should be\n# incremented each time you make changes to the application.\n# appVersion: 1.16.0\nkenuenonoMacBook-Air:nodejs-ex-k kenueno$ \n")),Object(o.b)("p",null,"Try again. It should work. Run ",Object(o.b)("strong",{parentName:"p"},"helm lint")," command as follow."),Object(o.b)("pre",null,Object(o.b)("code",l({parentName:"pre"},{}),"kenuenonoMacBook-Air:nodejs-ex-k kenueno$ helm lint\n==> Linting .\n\n1 chart(s) linted, 0 chart(s) failed\nkenuenonoMacBook-Air:nodejs-ex-k kenueno$ \n")),Object(o.b)("p",null,"Now it works. Yes!!  We need to make sure that the ",Object(o.b)("strong",{parentName:"p"},"version")," in the chart."),Object(o.b)("ol",{start:6},Object(o.b)("li",{parentName:"ol"},"Install the chart\nWe will install the chart. Move (change directory) to the parent directory (alpha directory).")),Object(o.b)("pre",null,Object(o.b)("code",l({parentName:"pre"},{}),"kenuenonoMacBook-Air:nodejs-ex-k kenueno$ cd ..\nkenuenonoMacBook-Air:alpha kenueno$ pwd\n/Users/kenueno/RedHat/OpenShift/4.3/azure/redhat-helm-charts/alpha\nkenuenonoMacBook-Air:alpha kenueno$ \n")),Object(o.b)("p",null,"Run ",Object(o.b)("strong",{parentName:"p"},"helm install")," command.  Here is the usage of the command:"),Object(o.b)("blockquote",null,Object(o.b)("p",{parentName:"blockquote"}," helm install ","[NAME][CHART]"," ","[flags]")),Object(o.b)("pre",null,Object(o.b)("code",l({parentName:"pre"},{}),"kenuenonoMacBook-Air:alpha kenueno$ helm install nodejs-chart nodejs-ex-k\nNAME: nodejs-chart\nLAST DEPLOYED: Wed Mar 18 00:31:24 2020\nNAMESPACE: nodejs-ex-k\nSTATUS: deployed\nREVISION: 1\nTEST SUITE: None\nkenuenonoMacBook-Air:alpha kenueno$ \n")),Object(o.b)("ol",{start:7},Object(o.b)("li",{parentName:"ol"},"Verify that the chart has installed successfully\nRun ",Object(o.b)("strong",{parentName:"li"},"helm list")," command as follow.")),Object(o.b)("pre",null,Object(o.b)("code",l({parentName:"pre"},{}),"kenuenonoMacBook-Air:alpha kenueno$ helm list\nNAME            NAMESPACE   REVISION    UPDATED                                 STATUS      CHART               APP VERSION\nnodejs-chart    nodejs-ex-k 1           2020-03-18 00:31:24.217591 +0900 JST    deployed    nodejs-ex-k-0.1.0              \nkenuenonoMacBook-Air:alpha kenueno$ \n")),Object(o.b)("p",null,"Make sure that there is ",Object(o.b)("strong",{parentName:"p"},"nodejs-chart")," helm chart is displayed."),Object(o.b)("ol",{start:8},Object(o.b)("li",{parentName:"ol"},"Verity that the application is running on Web Console\nOn the OpenShift web console, you can verify that the application you installed via Helm is running.")),Object(o.b)("img",{src:"/assets/img/day2/helm7.png",alt:"helm7",title:"Web Console"}),Object(o.b)("img",{src:"/assets/img/day2/helm8.png",alt:"helm8",title:"Web Console"}),Object(o.b)("img",{src:"/assets/img/day2/helm9.png",alt:"helm9",title:"Web Console"}),Object(o.b)("p",null,Object(o.b)("a",l({parentName:"p"},{href:"https://docs.openshift.com/container-platform/4.3/cli_reference/helm_cli/getting-started-with-helm-on-openshift-container-platform.html#creating-a-custom-helm-chart-on-openshift_getting-started-with-helm-on-openshift"}),"https://docs.openshift.com/container-platform/4.3/cli_reference/helm_cli/getting-started-with-helm-on-openshift-container-platform.html#creating-a-custom-helm-chart-on-openshift_getting-started-with-helm-on-openshift")))}s.isMDXComponent=!0},pEPl:function(e){e.exports=JSON.parse('{"data":{"site":{"siteMetadata":{"repository":{"baseUrl":"https://github.com/ibm-cloud-architecture/cloudpak8s","subDirectory":"/","branch":"master"}}}}}')},pOBw:function(e){e.exports=JSON.parse('{"data":{"site":{"pathPrefix":""}}}')}}]);
//# sourceMappingURL=component---src-pages-day-2-sup-helm-3-index-mdx-93cfc3aa1304f1ad2f73.js.map